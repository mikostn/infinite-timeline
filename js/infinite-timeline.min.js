
jQuery(function(){if(0==jQuery("#infinite_timeline").length){return}jQuery(window).load(function(){path="";if(jQuery("#infinite_timeline .rewrite_url").length){path=new Array();path.push(location.href+"?infinite_timeline_next=");path.push("")}var b=jQuery("#infinite_timeline img.loading").attr("src");jQuery("#infinite_timeline").infinitescroll({navSelector:"#infinite_timeline .pagenation",nextSelector:"#infinite_timeline .pagenation a",itemSelector:"#infinite_timeline .box",loading:{img:b,},path:path},function(c){jQuery(c).imagesLoaded(function(){infinite_timeline_adjust_vertical_position(c);jQuery("#infscr-loading").remove();a()})});function a(){if(0==jQuery("#timeline-year-list").length){jQuery("#infinite_timeline").prepend('<ul id="timeline-year-list"></ul>')}var e=jQuery(".year_head").length;var f=jQuery("#infinite_timeline .item").length;var d=(jQuery(window).height()-60-15*2-(e*24))/e;var c=d/f;jQuery("#timeline-year-list").empty();jQuery("#timeline-year-list").append('<li class="year-list-item-top"><a href="#timeline-top"><i class="fa fa-home"></i></a></li>');jQuery.each(jQuery(".year_head"),function(){var h=jQuery(this).data().yearpost;var g=jQuery(jQuery("[data-yearpost="+h+"]")).children(".item").length;console.log(h+" "+g);var i=jQuery('<li class="year-list-item"><span></span><a href="#'+jQuery(this).attr("name")+'">'+jQuery(this).text()+"</a></li>");i.css("margin-top",g*c+"px");jQuery("#timeline-year-list").append(i)});offset=jQuery("#infinite_timeline").offset();console.log(offset);jQuery("#timeline-year-list").affix({offset:{top:function(){return(this.top=offset.top-70)},bottom:function(){return(this.bottom=offset.top+jQuery("#infinite_timeline").outerHeight())}}})}infinite_timeline_adjust_vertical_position(0);a()})});function infinite_timeline_adjust_vertical_position(a){var b;if(a){b=jQuery(a).find(".item")}else{b=jQuery("#infinite_timeline .item")}b.each(function(f,g){var h=parseInt(jQuery(this).offset().top);var e=h+parseInt(jQuery(this).outerHeight());var j=0;if(jQuery(this).prev().length){j=parseInt(jQuery(this).prev().offset().top+jQuery(this).prev().outerHeight())}if(j>=e){var d=parseInt(jQuery(this).find(".title").height());if(jQuery(this).find("img").length){d=parseInt(jQuery(this).find("img").height())}var c=parseInt(jQuery(this).css("margin-top"));c+=j-h-d;jQuery(this).css("margin-top",c+"px")}})};