
jQuery(function(){if(0==jQuery("#infinite_timeline").length){return}jQuery(window).load(function(){path="";if(jQuery("#infinite_timeline .rewrite_url").length){path=new Array();path.push(location.href+"?infinite_timeline_next=");path.push("")}var c=jQuery("#infinite_timeline img.loading").attr("src");jQuery("#infinite_timeline").infinitescroll({navSelector:"#infinite_timeline .pagenation",nextSelector:"#infinite_timeline .pagenation a",itemSelector:"#infinite_timeline .box",loading:{img:c,},path:path},function(d){jQuery(d).imagesLoaded(function(){infinite_timeline_adjust_vertical_position(d);jQuery("#infscr-loading").remove();b()})});function b(){var f=90;if(0==jQuery("#infinite_timeline .timeline-year-list").length){jQuery("#infinite_timeline").prepend('<div class="timeline-container"><ul class="timeline-year-list nav"></ul></div>')}var g=jQuery(".year_head").length;var i=jQuery("#infinite_timeline .item").length;var e=(jQuery(window).height()-f-15-(g*24))/g;var d=e/i;var h=true;jQuery("#infinite_timeline .timeline-year-list").empty();jQuery("#infinite_timeline .timeline-year-list").append('<li class="year-list-item-top"><a href="#timeline-top"><i class="fa fa-home"></i></a></li>');jQuery.when(jQuery.each(jQuery(".year_head"),function(){var k=jQuery(this).data().yearpost;var j=jQuery(jQuery("[data-yearpost="+k+"]")).children(".item").length;var l=jQuery('<li class="year-list-item"><span></span><a href="#'+jQuery(this).attr("name")+'">'+jQuery(this).text()+"</a></li>");if(!h){l.css("margin-top",j*d+"px")}h=false;jQuery("#infinite_timeline .timeline-year-list").append(l)})).done(function(){var j=jQuery("#infinite_timeline").offset().top;jQuery("#infinite_timeline .timeline-year-list").affix({offset:{top:function(){return(this.top=j-f)},bottom:function(){return(this.bottom=jQuery(document).height()-(j+jQuery("#infinite_timeline").height())+f)}}})})}infinite_timeline_adjust_vertical_position(0);b();var a;jQuery(window).on("resize",function(d){clearTimeout(a);a=setTimeout(function(){b()},400)})})});function infinite_timeline_adjust_vertical_position(a){var b;if(a){b=jQuery(a).find(".item")}else{b=jQuery("#infinite_timeline .item")}b.each(function(f,g){var h=parseInt(jQuery(this).offset().top);var e=h+parseInt(jQuery(this).outerHeight());var j=0;if(jQuery(this).prev().length){j=parseInt(jQuery(this).prev().offset().top+jQuery(this).prev().outerHeight())}if(j>=e){var d=parseInt(jQuery(this).find(".title").height());if(jQuery(this).find("img").length){d=parseInt(jQuery(this).find("img").height())}var c=parseInt(jQuery(this).css("margin-top"));c+=j-h-d;jQuery(this).css("margin-top",c+"px")}})};